<div class="w-full h-auto gap-[26px]">
	<div class="w-full flex flex-col gap-8">

		<!-- Header -->
		<header class="w-full h-auto flex flex-col gap-5">

			<!-- Dashboard welcome header with period selector -->
			<div class="w-full flex justify-between items-center">
				<div>
					<span class="text-on-surface mat-title-large">
						Welcome to your dashboard, {{ program()?.name }}!
					</span>
					<div class="text-on-surface-variant mat-body-medium mt-1">
						Today is {{ today | date:'EEEE, d MMM yyyy' }}
					</div>
				</div>
				<div>
					<button mat-button [matMenuTriggerFor]="periodMenu" class="flex items-center gap-2 border border-outline-variant rounded px-4 py-2">
						<mat-icon class="text-outline">calendar_today</mat-icon>
						<span class="text-on-surface">{{ getPeriodLabel(selectedPeriod()) }}</span>
						<mat-icon class="text-outline">arrow_drop_down</mat-icon>
					</button>
					<mat-menu #periodMenu="matMenu">
						@for (option of periodOptions; track option.value) {
							<button mat-menu-item (click)="onPeriodChange(option.value)" 
								[class.bg-surface-container]="selectedPeriod() === option.value">
								{{ option.label }}
							</button>
						}
					</mat-menu>
				</div>
			</div>

			<!-- Statistics info -->
			<div class="w-full flex flex-row gap-5">

				<!-- Revenue and Commission stats -->
				<div class="w-1/2 h-[260px] flex flex-col border border-outline-variant rounded px-4">

					<!-- Total Revenue stats -->
					<div class="w-full flex flex-col h-[130px] px-2 py-6 gap-4">
						<div class="mat-body-large text-on-surface underline decoration-dotted decoration-outline decoration-[10%] underline-offset-[40%]">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '100px',
									height: '24px',
								}" />
							} @else {
								<span
									[matTooltip]="tooltips.get('revenue')!"
									matTooltipPosition="above"
								>
									Total Revenue
								</span>
							}
						</div>
						<div class="mat-headline-large text-on-surface">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '200px',
									height: '40px',
								}" />
							} @else {
								<span>{{ analytics()?.totalRevenue | formatCurrency:program()?.currency }}</span>
							}
						</div>
					</div>

					<mat-divider class="border-outline-variant"></mat-divider>

					<!-- Total Commission stats -->
			<div class="w-full flex flex-col h-[130px] px-2 py-6 gap-4">
						<div class="mat-body-large text-on-surface underline decoration-dotted decoration-outline decoration-[10%] underline-offset-[40%]">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '100px',
									height: '24px',
								}" />
							} @else {
								<span
									[matTooltip]="tooltips.get('commissions')!"
									matTooltipPosition="above"
								>
									Total Commission
								</span>
							}
						</div>
						<div class="mat-headline-large text-secondary">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '200px',
									height: '40px',
								}" />
							} @else {
								<span>{{ analytics()?.totalCommissions | formatCurrency:program()?.currency }}</span>
							}
						</div>
					</div>
				</div>

				<!-- Signups and Purchases Stats -->
				<div class="w-1/2 h-[260px] flex flex-col gap-4">

					<!-- Signups -->
					<div class="w-full flex flex-col h-[122px] border border-outline-variant rounded p-6 gap-4">
						<div class="mat-body-large text-on-surface underline decoration-dotted decoration-outline decoration-[10%] underline-offset-[40%]">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '60px',
									height: '24px',
								}" />
							} @else {
								<span
									[matTooltip]="tooltips.get('signups')!"
									matTooltipPosition="above"
								>
									Signups
								</span>
							}
						</div>
						<div class="mat-title-large text-on-surface">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '100px',
									height: '28px',
								}" />
							} @else {
								<span>{{ analytics()?.totalSignups | zeroToDash }}</span>
							}
						</div>
					</div>

					<!-- Purchases -->
					<div class="w-full flex flex-col h-[122px] border border-outline-variant rounded p-6 gap-4">
						<div class="mat-body-large text-on-surface underline decoration-dotted decoration-outline decoration-[10%] underline-offset-[40%]">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '75px',
									height: '24px',
								}" />
							} @else {
								<span
									[matTooltip]="tooltips.get('purchases')!"
									matTooltipPosition="above"
								>
									Purchases
								</span>
							}
						</div>
						<div class="mat-title-large text-on-surface">
							@if (isAnalyticsLoading()) {
								<ngx-skeleton-loader [theme]="{
									width: '100px',
									height: '28px',
								}" />
							} @else {
								<span>{{ analytics()?.totalPurchases | zeroToDash }}</span>
							}
						</div>
					</div>
				</div>
			</div>
		</header>

		<!-- Top Promoters Section -->
		<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
			<!-- Top promoters by signups -->
			<ng-container *ngIf="isSignupsLoading(); else signupsContent">
				<div class="flex flex-col space-y-3">
					<ngx-skeleton-loader [theme]="{ width: '60%', height: '18px', borderRadius: '4px' }"></ngx-skeleton-loader>
					<ngx-skeleton-loader *ngFor="let i of [1,2,3,4,5]"
						[theme]="{ width: '100%', height: '36px', borderRadius: '8px' }">
					</ngx-skeleton-loader>
				</div>
			</ng-container>
			<ng-template #signupsContent>
				<app-popularity-chart
					[title]="'Top promoters by signups'"
					[labelColumn]="'Promoters'"
					[valueColumn]="'Commission'"
					[data]="signupsPopularityData()"
					[navigationText]="'View all promoters'"
					[navigationLink]="getSignupsPromotersLink()"
					[currency]="program()?.currency || 'INR'"
				>
				</app-popularity-chart>
			</ng-template>

			<!-- Top promoters by purchases -->
			<ng-container *ngIf="isPurchasesLoading(); else purchasesContent">
				<div class="flex flex-col space-y-3">
					<ngx-skeleton-loader [theme]="{ width: '60%', height: '18px', borderRadius: '4px' }"></ngx-skeleton-loader>
					<ngx-skeleton-loader *ngFor="let i of [1,2,3,4,5]"
						[theme]="{ width: '100%', height: '36px', borderRadius: '8px' }">
					</ngx-skeleton-loader>
				</div>
			</ng-container>
			<ng-template #purchasesContent>
				<app-popularity-chart
					[title]="'Top promoters by purchases'"
					[labelColumn]="'Promoters'"
					[valueColumn]="'Commission'"
					[data]="purchasesPopularityData()"
					[navigationText]="'View all promoters'"
					[navigationLink]="getPurchasesPromotersLink()"
					[showSubValue]="true"
					[currency]="program()?.currency || 'INR'"
				>
				</app-popularity-chart>
			</ng-template>
		</div>

		<!-- Analytics Chart Section -->
		<div class="mt-6 border border-outline-variant rounded-lg overflow-hidden">
			<ng-container *ngIf="isDayWiseLoading(); else chartContent">
				<div class="h-[450px] flex items-center justify-center">
					<ngx-skeleton-loader [theme]="{ width: '90%', height: '350px', borderRadius: '8px' }">
					</ngx-skeleton-loader>
				</div>
			</ng-container>
			<ng-template #chartContent>
				<app-analytics-chart
					[graphData]="dayWiseData()"
					[period]="selectedPeriod()"
					[currency]="program()?.currency || 'INR'"
				>
				</app-analytics-chart>
			</ng-template>
		</div>

	</div>
</div>
