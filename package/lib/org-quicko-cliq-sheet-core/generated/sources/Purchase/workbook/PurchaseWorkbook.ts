// Auto-generated by @org.quicko/sheet-generator@6.0.2

import { Workbook, Sheet } from '@org.quicko/sheet-core';
import { Expose, Type } from 'class-transformer';
import { ValidateNested } from 'class-validator';
import 'reflect-metadata';
import { PurchaseSummarySheet } from '../sheets/purchase-summary-sheet/PurchaseSummarySheet';
import { PurchaseSheet } from '../sheets/purchase-sheet/PurchaseSheet';

@Reflect.metadata('name', 'PurchaseWorkbook')
export class PurchaseWorkbook extends Workbook {
    @Expose()
    @ValidateNested({ each: true })
    @Type(() => Sheet, {
        keepDiscriminatorProperty: true,
        discriminator: {
            property: 'name',
            subTypes: [
                {
					value: PurchaseSummarySheet,
					name: 'purchase_summary_sheet'
				},
				{
					value: PurchaseSheet,
					name: 'purchase_sheet'
				}
            ],
        },
    })
    sheets: Array<Sheet> = new Array<Sheet>();
    
    addPurchaseSummarySheet(sheet: PurchaseSummarySheet): void {
        this.addSheet(sheet);
    }

    getPurchaseSummarySheet(): PurchaseSummarySheet {
        if (!this.getSheet('purchase_summary_sheet')) {
            this.addSheet(new PurchaseSummarySheet());
        }
        return this.getSheet('purchase_summary_sheet') as PurchaseSummarySheet;
    }

    addPurchaseSheet(sheet: PurchaseSheet): void {
        this.addSheet(sheet);
    }

    getPurchaseSheet(): PurchaseSheet {
        if (!this.getSheet('purchase_sheet')) {
            this.addSheet(new PurchaseSheet());
        }
        return this.getSheet('purchase_sheet') as PurchaseSheet;
    }
}